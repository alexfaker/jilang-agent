import{g as b,q as _,v as E,h as O,c as n,a as e,F as U,i as z,x as V,t as c,y as u,z as p,A as M,j as g,B as P,o as i,n as A}from"./index-f19ebc4a.js";const $={class:"flex-1 overflow-y-auto p-6"},J={class:"border-b mb-6"},L={class:"flex space-x-8"},R=["onClick"],K={key:0,class:"space-y-6"},W={class:"bg-white rounded-lg shadow-sm p-6"},Y={class:"mb-6"},H={class:"flex items-center"},Q=["src"],X=["disabled"],Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},ee={class:"mb-6"},se={class:"mb-6"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},oe={class:"flex justify-end"},ae=["disabled"],re={class:"bg-white rounded-lg shadow-sm p-6"},le={class:"mb-6"},de={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ne=["onClick"],ie={class:"text-sm font-medium"},ue={key:1,class:"space-y-6"},ge={class:"bg-white rounded-lg shadow-sm p-6"},me={class:"space-y-4"},be={key:0,class:"text-sm text-red-600 mt-1"},ce={class:"flex justify-end mt-6"},pe=["disabled"],ve={key:2,class:"bg-white rounded-lg shadow-sm p-6"},fe={key:3,class:"bg-white rounded-lg shadow-sm p-6"},ye={key:4,class:"bg-white rounded-lg shadow-sm p-6"},xe={key:5,class:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg"},we={class:"text-red-800"},Pe={key:6,class:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg"},he={class:"text-green-800"},_e={__name:"SettingsView",setup(ke){const m=b("account"),N=b(!1),f=b(!1),y=b(!1),x=b(!1),a=b(""),d=b(""),j=[{id:"account",name:"账户设置"},{id:"workflow",name:"工作流设置"},{id:"security",name:"安全设置"},{id:"api",name:"API密钥"},{id:"notification",name:"通知设置"}],G=[{value:"light",name:"浅色主题",colorClass:"bg-white border border-gray-300"},{value:"dark",name:"深色主题",colorClass:"bg-gray-800 border border-gray-700"},{value:"auto",name:"跟随系统",colorClass:"bg-gradient-to-r from-white to-gray-800 border border-gray-300"}],o=_({id:0,userID:"",username:"",email:"",fullName:"",avatar:"",bio:"",timezone:"Asia/Shanghai",language:"zh_CN",theme:"light",role:"",points:0}),h=_({}),r=_({currentPassword:"",newPassword:"",confirmPassword:""}),k=E(()=>r.newPassword&&r.confirmPassword&&r.newPassword!==r.confirmPassword),T=async()=>{var l,s;try{N.value=!0,a.value="";const t=await P.getProfile();console.log("API Response:",t),t.status==="success"?(console.log("User data:",t.data),Object.assign(o,t.data),Object.assign(h,t.data)):a.value=t.message||"获取用户资料失败"}catch(t){console.error("Fetch profile error:",t),a.value="获取用户资料失败: "+(((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message)}finally{N.value=!1}},I=async()=>{var l,s;try{f.value=!0,a.value="",d.value="";const t=await P.updateProfile({email:o.email,fullName:o.fullName,bio:o.bio,timezone:o.timezone,language:o.language,theme:o.theme});t.status==="success"?(d.value="用户资料更新成功",Object.assign(h,o),setTimeout(()=>{d.value=""},3e3)):a.value=t.message||"更新用户资料失败"}catch(t){a.value="更新用户资料失败: "+(((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message)}finally{f.value=!1}},S=()=>{Object.assign(o,h),a.value="",d.value=""},D=async l=>{var t,w;const s=l.target.files[0];if(s){if(s.size>2*1024*1024){a.value="文件大小不能超过2MB";return}if(!["image/jpeg","image/png","image/gif"].includes(s.type)){a.value="只支持 JPG, PNG, GIF 格式的图片";return}try{y.value=!0,a.value="";const v=new FormData;v.append("avatar",s);const C=await P.updateProfileWithAvatar(v);C.status==="success"?(o.avatar=C.data.avatar,d.value="头像上传成功",setTimeout(()=>{d.value=""},3e3)):a.value=C.message||"头像上传失败"}catch(v){a.value="头像上传失败: "+(((w=(t=v.response)==null?void 0:t.data)==null?void 0:w.message)||v.message)}finally{y.value=!1,l.target.value=""}}},B=()=>{o.avatar="/default-avatar.png"},F=l=>{l.target.src="/default-avatar.png"},q=async()=>{var l,s;if(k.value){a.value="密码不匹配";return}try{x.value=!0,a.value="",d.value="";const t=await P.changePassword({currentPassword:r.currentPassword,newPassword:r.newPassword});t.status==="success"?(d.value="密码修改成功",r.currentPassword="",r.newPassword="",r.confirmPassword="",setTimeout(()=>{d.value=""},3e3)):a.value=t.message||"密码修改失败"}catch(t){a.value="密码修改失败: "+(((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message)}finally{x.value=!1}};return O(()=>{T()}),(l,s)=>(i(),n("div",$,[s[31]||(s[31]=e("div",{class:"mb-6"},[e("h1",{class:"text-xl font-semibold text-gray-800"},"设置"),e("p",{class:"text-gray-600 mt-1"},"管理您的账户和偏好设置")],-1)),e("div",J,[e("nav",L,[(i(),n(U,null,z(j,t=>e("button",{key:t.id,onClick:w=>m.value=t.id,class:A([m.value===t.id?"py-4 px-1 border-b-2 border-indigo-600 text-indigo-600 font-medium text-sm":"py-4 px-1 text-gray-500 hover:text-indigo-600 font-medium text-sm"])},c(t.name),11,R)),64))])]),m.value==="account"?(i(),n("div",K,[e("div",W,[s[21]||(s[21]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"个人信息",-1)),e("form",{onSubmit:V(I,["prevent"])},[e("div",Y,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"头像",-1)),e("div",H,[e("img",{src:o.avatar||"/default-avatar.png",class:"w-16 h-16 rounded-full mr-4 object-cover",alt:"当前头像",onError:F},null,40,Q),e("div",null,[e("input",{type:"file",ref:"avatarInput",onChange:D,accept:"image/*",class:"hidden"},null,544),e("button",{type:"button",onClick:s[0]||(s[0]=t=>l.$refs.avatarInput.click()),disabled:y.value,class:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg text-sm mr-2"},c(y.value?"上传中...":"上传新头像"),9,X),e("button",{type:"button",onClick:B,class:"text-gray-600 hover:text-gray-800 px-4 py-2 border border-gray-300 rounded-lg text-sm"}," 移除 "),s[10]||(s[10]=e("p",{class:"text-xs text-gray-500 mt-1"},"允许的文件类型: PNG, JPG, GIF. 最大文件大小: 2MB",-1))])])]),e("div",Z,[e("div",null,[s[12]||(s[12]=e("label",{for:"username",class:"block text-sm font-medium text-gray-700 mb-1"},"用户名",-1)),u(e("input",{type:"text",id:"username","onUpdate:modelValue":s[1]||(s[1]=t=>o.username=t),readonly:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 cursor-not-allowed"},null,512),[[p,o.username]]),s[13]||(s[13]=e("p",{class:"text-xs text-gray-500 mt-1"},"用户名不可修改",-1))]),e("div",null,[s[14]||(s[14]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-1"},"电子邮箱",-1)),u(e("input",{type:"email",id:"email","onUpdate:modelValue":s[2]||(s[2]=t=>o.email=t),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[p,o.email]])])]),e("div",ee,[s[15]||(s[15]=e("label",{for:"fullName",class:"block text-sm font-medium text-gray-700 mb-1"},"全名",-1)),u(e("input",{type:"text",id:"fullName","onUpdate:modelValue":s[3]||(s[3]=t=>o.fullName=t),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[p,o.fullName]])]),e("div",se,[s[16]||(s[16]=e("label",{for:"bio",class:"block text-sm font-medium text-gray-700 mb-1"},"个人简介",-1)),u(e("textarea",{id:"bio","onUpdate:modelValue":s[4]||(s[4]=t=>o.bio=t),rows:"4",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500",placeholder:"介绍一下自己..."},null,512),[[p,o.bio]])]),e("div",te,[e("div",null,[s[18]||(s[18]=e("label",{for:"timezone",class:"block text-sm font-medium text-gray-700 mb-1"},"时区",-1)),u(e("select",{id:"timezone","onUpdate:modelValue":s[5]||(s[5]=t=>o.timezone=t),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"},s[17]||(s[17]=[e("option",{value:"Asia/Shanghai"},"中国标准时间 (GMT+8)",-1),e("option",{value:"America/New_York"},"美国东部时间 (GMT-5)",-1),e("option",{value:"Europe/London"},"格林威治标准时间 (GMT)",-1),e("option",{value:"Asia/Tokyo"},"日本标准时间 (GMT+9)",-1)]),512),[[M,o.timezone]])]),e("div",null,[s[20]||(s[20]=e("label",{for:"language",class:"block text-sm font-medium text-gray-700 mb-1"},"语言",-1)),u(e("select",{id:"language","onUpdate:modelValue":s[6]||(s[6]=t=>o.language=t),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"},s[19]||(s[19]=[e("option",{value:"zh_CN"},"简体中文",-1),e("option",{value:"en_US"},"English (US)",-1),e("option",{value:"ja_JP"},"日本語",-1),e("option",{value:"ko_KR"},"한국어",-1)]),512),[[M,o.language]])])]),e("div",oe,[e("button",{type:"button",onClick:S,class:"mr-4 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"}," 重置 "),e("button",{type:"submit",disabled:f.value,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white rounded-lg"},c(f.value?"保存中...":"保存更改"),9,ae)])],32)]),e("div",re,[s[23]||(s[23]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"界面设置",-1)),e("div",le,[s[22]||(s[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"主题",-1)),e("div",de,[(i(),n(U,null,z(G,t=>e("div",{key:t.value,onClick:w=>o.theme=t.value,class:A([o.theme===t.value?"border-2 border-indigo-600 bg-indigo-50":"border border-gray-200 hover:bg-gray-50","rounded-lg p-4 flex items-center cursor-pointer transition-all"])},[e("div",{class:A([t.colorClass,"w-6 h-6 rounded-full mr-3"])},null,2),e("span",ie,c(t.name),1)],10,ne)),64))])])])])):g("",!0),m.value==="security"?(i(),n("div",ue,[e("div",ge,[s[27]||(s[27]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"修改密码",-1)),e("form",{onSubmit:V(q,["prevent"])},[e("div",me,[e("div",null,[s[24]||(s[24]=e("label",{for:"currentPassword",class:"block text-sm font-medium text-gray-700 mb-1"},"当前密码",-1)),u(e("input",{type:"password",id:"currentPassword","onUpdate:modelValue":s[7]||(s[7]=t=>r.currentPassword=t),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[p,r.currentPassword]])]),e("div",null,[s[25]||(s[25]=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700 mb-1"},"新密码",-1)),u(e("input",{type:"password",id:"newPassword","onUpdate:modelValue":s[8]||(s[8]=t=>r.newPassword=t),required:"",minlength:"8",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[p,r.newPassword]])]),e("div",null,[s[26]||(s[26]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700 mb-1"},"确认新密码",-1)),u(e("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":s[9]||(s[9]=t=>r.confirmPassword=t),required:"",minlength:"8",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[p,r.confirmPassword]]),k.value?(i(),n("p",be,"密码不匹配")):g("",!0)])]),e("div",ce,[e("button",{type:"submit",disabled:x.value||k.value,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white rounded-lg"},c(x.value?"修改中...":"修改密码"),9,pe)])],32)])])):g("",!0),m.value==="workflow"?(i(),n("div",ve,s[28]||(s[28]=[e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"工作流设置",-1),e("p",{class:"text-gray-600"},"工作流相关设置功能正在开发中...",-1)]))):g("",!0),m.value==="api"?(i(),n("div",fe,s[29]||(s[29]=[e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"API密钥",-1),e("p",{class:"text-gray-600"},"API密钥管理功能正在开发中...",-1)]))):g("",!0),m.value==="notification"?(i(),n("div",ye,s[30]||(s[30]=[e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"通知设置",-1),e("p",{class:"text-gray-600"},"通知设置功能正在开发中...",-1)]))):g("",!0),a.value?(i(),n("div",xe,[e("p",we,c(a.value),1)])):g("",!0),d.value?(i(),n("div",Pe,[e("p",he,c(d.value),1)])):g("",!0)]))}};export{_e as default};
